<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ডেটা এডিট এবং ডিলিট</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #0f0f0f;
      color: #00ff00;
      text-align: center;
      padding: 20px;
    }
    button {
      padding: 10px 20px;
      background-color: #00ff00;
      color: black;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #008000;
    }
    table {
      width: 100%;
      margin: 20px auto;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #00ff00;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #008000;
    }
    select, input[type="text"] {
      padding: 10px;
      width: 300px;
      margin: 10px;
    }
    #dataContainer {
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>ডেটা এডিট এবং ডিলিট পেজ</h1>

  <button onclick="window.open('index.html', '_self')">ড্যাশবোর্ড</button>
  <button onclick="window.open('data-entry.html', '_self')">ডেটা এন্ট্রি</button>
  <button onclick="window.open('report.html', '_self')">রিপোর্ট</button>

  <h2>অর্ডার অনুসন্ধান করুন:</h2>
  <select id="orderDropdown">
    <option value="">অর্ডার নাম্বার নির্বাচন করুন</option>
  </select>
  <button onclick="searchByDropdown()">সিলেক্ট করুন</button>

  <h3>অথবা অর্ডার নম্বর টাইপ করুন:</h3>
  <input type="text" id="searchOrderNo" placeholder="অর্ডার নং লিখুন">
  <button onclick="searchOrder()">সার্চ করুন</button>

  <div id="dataContainer">
    <h2>সংশোধনযোগ্য ডেটা</h2>
    <table>
      <thead>
        <tr>
          <th>অর্ডার নং</th>
          <th>পার্টি নাম</th>
          <th>শেড নং</th>
          <th>অর্ডার পরিমাণ</th>
          <th>ব্যালেন্স পরিমাণ</th>
          <th>মন্তব্য</th>
          <th>কর্ম</th>
        </tr>
      </thead>
      <tbody id="dataTable"></tbody>
    </table>
  </div>

  <script>
    window.onload = populateDropdown;

    // ড্রপডাউন অপশন তৈরি
    function populateDropdown() {
      const dataEntries = JSON.parse(localStorage.getItem('dataEntries')) || [];
      const dropdown = document.getElementById('orderDropdown');

      dataEntries.forEach(entry => {
        const option = document.createElement('option');
        option.value = entry.orderNo;
        option.textContent = entry.orderNo;
        dropdown.appendChild(option);
      });
    }

    // ড্রপডাউন থেকে সার্চ
    function searchByDropdown() {
      const orderNo = document.getElementById('orderDropdown').value;
      if (orderNo) {
        searchOrderByNumber(orderNo);
      } else {
        alert('অনুগ্রহ করে একটি অর্ডার নির্বাচন করুন!');
      }
    }

    // ম্যানুয়াল সার্চ
    function searchOrder() {
      const orderNo = document.getElementById('searchOrderNo').value;
      searchOrderByNumber(orderNo);
    }

    function searchOrderByNumber(orderNo) {
      const dataEntries = JSON.parse(localStorage.getItem('dataEntries')) || [];
      const filteredEntries = dataEntries.filter(entry => entry.orderNo === orderNo);

      const dataTable = document.getElementById('dataTable');
      dataTable.innerHTML = ''; // পূর্ববর্তী ডেটা মুছে ফেলা

      if (filteredEntries.length === 0) {
        alert('কোনো ডেটা পাওয়া যায়নি!');
        document.getElementById('dataContainer').style.display = 'none';
        return;
      }

      document.getElementById('dataContainer').style.display = 'block';

      filteredEntries.forEach((entry, index) => {
        const row = document.createElement('tr');

        row.innerHTML = `
          <td><input type="text" value="${entry.orderNo}" disabled></td>
          <td><input type="text" value="${entry.partyName}"></td>
          <td><input type="text" value="${entry.shadeNo}"></td>
          <td><input type="number" value="${entry.orderQty}"></td>
          <td><input type="number" value="${entry.balQty}"></td>
          <td><input type="text" value="${entry.remarks}"></td>
          <td>
            <button onclick="updateData(${index})">আপডেট করুন</button>
            <button onclick="deleteData(${index})">ডিলিট করুন</button>
          </td>
        `;
        dataTable.appendChild(row);
      });
    }

    // ডেটা আপডেট ফাংশন
    function updateData(index) {
      const dataEntries = JSON.parse(localStorage.getItem('dataEntries')) || [];
      const updatedRow = document.querySelectorAll('#dataTable tr')[index];

      const updatedEntry = {
        orderNo: updatedRow.cells[0].querySelector('input').value,
        partyName: updatedRow.cells[1].querySelector('input').value,
        shadeNo: updatedRow.cells[2].querySelector('input').value,
        orderQty: updatedRow.cells[3].querySelector('input').value,
        balQty: updatedRow.cells[4].querySelector('input').value,
        remarks: updatedRow.cells[5].querySelector('input').value,
      };

      dataEntries[index] = updatedEntry;
      localStorage.setItem('dataEntries', JSON.stringify(dataEntries));
      alert('ডেটা সফলভাবে আপডেট হয়েছে!');
    }

    // ডেটা ডিলিট ফাংশন
    function deleteData(index) {
      const dataEntries = JSON.parse(localStorage.getItem('dataEntries')) || [];

      if (confirm('আপনি কি এই ডেটা মুছে ফেলতে চান?')) {
        dataEntries.splice(index, 1);
        localStorage.setItem('dataEntries', JSON.stringify(dataEntries));
        alert('ডেটা সফলভাবে ডিলিট হয়েছে!');
        searchOrder(); // টেবিল আপডেট করা
      }
    }
  </script>
</body>
</html>