<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Expense Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <style>
    .currency::before {
      content: "৳";
      margin-right: 4px;
    }
    .action-menu {
      min-width: 100px;
    }
    .date-filter {
      max-width: 200px;
    }
  </style>
</head>
<body class="container-fluid py-4">
  <header class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 fw-bold"><i class="bi bi-wallet2"></i> Expense Manager</h1>
    <div class="d-flex gap-2">
      <select class="form-select date-filter" id="dateFilter">
        <option value="all">All Dates</option>
      </select>
    </div>
  </header>

  <div class="row g-4">
    <!-- Input Form -->
    <div class="col-lg-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <form id="expenseForm">
            <input type="hidden" id="editId">
            <div class="mb-3">
              <label class="form-label">Date</label>
              <input type="date" class="form-control" id="date" required>
            </div>
            
            <div class="mb-3">
              <label class="form-label">Category</label>
              <select class="form-select" id="category" required>
                <option value="Food">Food</option>
                <option value="Transport">Transport</option>
                <option value="Housing">Housing</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div class="mb-3">
              <label class="form-label">Item Name</label>
              <input type="text" class="form-control" id="item" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Amount</label>
              <div class="input-group">
                <span class="input-group-text">৳</span>
                <input type="number" class="form-control" id="amount" step="0.01" required>
              </div>
            </div>

            <div class="d-grid gap-2">
              <button type="submit" class="btn btn-primary" id="saveBtn">
                <i class="bi bi-save"></i> Save Expense
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Data Table -->
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Category</th>
                  <th>Item</th>
                  <th>Amount</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="expenseTable">
                <!-- Data will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const ExpenseTracker = {
  expenses: JSON.parse(localStorage.getItem('expenses')) || [],
  
  init() {
    this.renderTable();
    this.setupEventListeners();
    this.populateDateFilter();
  },

  setupEventListeners() {
    document.getElementById('expenseForm').addEventListener('submit', (e) => this.saveExpense(e));
    document.getElementById('dateFilter').addEventListener('change', () => this.renderTable());
  },

  saveExpense(e) {
    e.preventDefault();
    
    const expense = {
      id: document.getElementById('editId').value || Date.now(),
      date: document.getElementById('date').value,
      category: document.getElementById('category').value,
      item: document.getElementById('item').value,
      amount: parseFloat(document.getElementById('amount').value).toFixed(2)
    };

    const index = this.expenses.findIndex(e => e.id === expense.id);
    if (index > -1) {
      this.expenses[index] = expense;
    } else {
      this.expenses.push(expense);
    }

    this.resetForm();
    this.renderTable();
    this.saveToLocalStorage();
  },

  editExpense(id) {
    const expense = this.expenses.find(e => e.id === id);
    document.getElementById('editId').value = expense.id;
    document.getElementById('date').value = expense.date;
    document.getElementById('category').value = expense.category;
    document.getElementById('item').value = expense.item;
    document.getElementById('amount').value = expense.amount;
    window.scrollTo({top: 0, behavior: 'smooth'});
  },

  deleteExpense(id) {
    if(confirm('Are you sure you want to delete this expense?')) {
      this.expenses = this.expenses.filter(e => e.id !== id);
      this.renderTable();
      this.saveToLocalStorage();
    }
  },

  renderTable() {
    const filtered = this.getFilteredExpenses();
    const html = filtered.map(expense => `
      <tr>
        <td>${expense.date}</td>
        <td>${expense.category}</td>
        <td>${expense.item}</td>
        <td class="currency">${expense.amount}</td>
        <td>
          <div class="dropdown">
            <button class="btn btn-sm" type="button" data-bs-toggle="dropdown">
              <i class="bi bi-three-dots-vertical"></i>
            </button>
            <ul class="dropdown-menu action-menu">
              <li><button class="dropdown-item" onclick="ExpenseTracker.editExpense(${expense.id})">
                <i class="bi bi-pencil"></i> Edit
              </button></li>
              <li><button class="dropdown-item text-danger" onclick="ExpenseTracker.deleteExpense(${expense.id})">
                <i class="bi bi-trash"></i> Delete
              </button></li>
            </ul>
          </div>
        </td>
      </tr>
    `).join('');

    document.getElementById('expenseTable').innerHTML = html;
    this.populateDateFilter();
  },

  getFilteredExpenses() {
    const dateFilter = document.getElementById('dateFilter').value;
    return dateFilter === 'all' 
      ? this.expenses 
      : this.expenses.filter(e => e.date === dateFilter);
  },

  populateDateFilter() {
    const dates = [...new Set(this.expenses.map(e => e.date))];
    const select = document.getElementById('dateFilter');
    select.innerHTML = `
      <option value="all">All Dates</option>
      ${dates.map(date => `<option value="${date}">${date}</option>`).join('')}
    `;
  },

  resetForm() {
    document.getElementById('expenseForm').reset();
    document.getElementById('editId').value = '';
  },

  saveToLocalStorage() {
    localStorage.setItem('expenses', JSON.stringify(this.expenses));
  }
};

// Initialize the app
document.addEventListener('DOMContentLoaded', () => {
  ExpenseTracker.init();
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>